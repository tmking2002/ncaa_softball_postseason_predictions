return(list(regionals, supers, semis, champ))
}
find_proportions <- function(results){
num_sims <- max(results[[2]]$sim_id)
proportions <- data.frame(team_name = unique(tournament_teams$Team))
for(i in 1:64){
proportions$regionals[i] = nrow(results[[1]][which(results[[1]]$team == proportions$team_name[i]),]) / num_sims
proportions$supers[i] = nrow(results[[2]][which(results[[2]]$team == proportions$team_name[i]),]) / num_sims
proportions$semis[i] = nrow(results[[3]][which(results[[3]]$semifinalists == proportions$team_name[i]),]) / num_sims
proportions$champs[i] = nrow(results[[4]][which(results[[4]]$wcws_champ == proportions$team_name[i]),]) / num_sims
}
return(proportions)
}
tictoc::tic()
results <- sim_tournament(num_sims = 10)
sim_tournament <- function(num_sims){
regionals <- data.frame()
supers <- data.frame()
semis <- data.frame()
champ <- data.frame()
for(i in 1:num_sims){
regional_champs <- c("Oklahoma", "Clemson", "Duke", "Stanford", "Alabama", "Northwestern", "Tennessee", "Texas",
"Florida St.", "Georgia", "Oklahoma St.", "Oregon", "Washington", "Louisiana", "Utah", "San Diego St.")
regionals <- rbind(regionals, data.frame(regional_champs, sim_id = i))
super_champs <- sim_supers(regionals)
supers <- rbind(supers, data.frame(super_champs, sim_id = i))
semifinalists <- sim_wcws(super_champs)
semis <- rbind(semis, data.frame(semifinalists, sim_id = i))
wcws_champ <- sim_champ(semifinalists)
champ <- rbind(champ, data.frame(wcws_champ, sim_id = i))
if(i %% 100 == 0) print(i)
}
return(list(regionals, supers, semis, champ))
}
find_proportions <- function(results){
num_sims <- max(results[[2]]$sim_id)
proportions <- data.frame(team_name = unique(tournament_teams$Team))
for(i in 1:64){
proportions$regionals[i] = nrow(results[[1]][which(results[[1]]$team == proportions$team_name[i]),]) / num_sims
proportions$supers[i] = nrow(results[[2]][which(results[[2]]$team == proportions$team_name[i]),]) / num_sims
proportions$semis[i] = nrow(results[[3]][which(results[[3]]$semifinalists == proportions$team_name[i]),]) / num_sims
proportions$champs[i] = nrow(results[[4]][which(results[[4]]$wcws_champ == proportions$team_name[i]),]) / num_sims
}
return(proportions)
}
tictoc::tic()
results <- sim_tournament(num_sims = 10)
regional_champs <- c("Oklahoma", "Clemson", "Duke", "Stanford", "Alabama", "Northwestern", "Tennessee", "Texas",
"Florida St.", "Georgia", "Oklahoma St.", "Oregon", "Washington", "Louisiana", "Utah", "San Diego St.")
sim_regionals
sim_regionals()
sim_tournament <- function(num_sims){
regionals <- data.frame()
supers <- data.frame()
semis <- data.frame()
champ <- data.frame()
for(i in 1:num_sims){
regional_champs <- data.frame(team = c("Oklahoma", "Clemson", "Duke", "Stanford", "Alabama", "Northwestern", "Tennessee", "Texas",
"Florida St.", "Georgia", "Oklahoma St.", "Oregon", "Washington", "Louisiana", "Utah", "San Diego St."),
region = unique(tournament_teams$Region))
regionals <- rbind(regionals, data.frame(regional_champs, sim_id = i))
super_champs <- sim_supers(regional_champs)
supers <- rbind(supers, data.frame(super_champs, sim_id = i))
semifinalists <- sim_wcws(super_champs)
semis <- rbind(semis, data.frame(semifinalists, sim_id = i))
wcws_champ <- sim_champ(semifinalists)
champ <- rbind(champ, data.frame(wcws_champ, sim_id = i))
if(i %% 100 == 0) print(i)
}
return(list(regionals, supers, semis, champ))
}
find_proportions <- function(results){
num_sims <- max(results[[1]]$sim_id)
proportions <- data.frame(team_name = unique(tournament_teams$Team))
for(i in 1:64){
proportions$regionals[i] = nrow(results[[1]][which(results[[1]]$team == proportions$team_name[i]),]) / num_sims
proportions$supers[i] = nrow(results[[2]][which(results[[2]]$team == proportions$team_name[i]),]) / num_sims
proportions$semis[i] = nrow(results[[3]][which(results[[3]]$semifinalists == proportions$team_name[i]),]) / num_sims
proportions$champs[i] = nrow(results[[4]][which(results[[4]]$wcws_champ == proportions$team_name[i]),]) / num_sims
}
return(proportions)
}
tictoc::tic()
results <- sim_tournament(num_sims = 10)
tictoc::toc()
proportions <- find_proportions(results)
View(proportions)
tictoc::tic()
results <- sim_tournament(num_sims = 10000)
tictoc::toc()
proportions <- find_proportions(results)
View(proportions)
logos <- rbind(load_espn_softball_scoreboard(2022)[c(2,4)] %>% `names<-`(c("team","logo")),
load_espn_softball_scoreboard(2022)[c(10,12)] %>% `names<-`(c("team","logo"))) %>%
distinct(team, logo) %>%
mutate(team = str_replace(team, "State", "St."),
team = str_replace(team, "Illinois", "Ill."),
team = str_replace(team, "Colorado", "Colo."),
team = str_replace(team, "Northern Kentucky", "Northern Ky."),
team = str_replace(team, "Boston University", "Boston U."),
team = str_replace(team, "Loyola Marymount", "LMU (CA)"),
team = str_replace(team, "Middle Tennessee", "Middle Tenn."),
team = str_replace(team, "Central Arkansas", "Central Ark."),
team = str_replace(team, "Long Island University", "LIU"),
team = str_replace(team, "&", "&amp;"),
team = str_replace(team, "North Carolina Central", "N.C. Central"),
team = str_replace(team, "Prairie View A&amp;M", "Prairie View")) %>%
rbind(data.frame(team = "George Mason", logo = "https://a.espncdn.com/combiner/i?img=/i/teamlogos/ncaa/500/2244.png&h=200&w=200"))
library(softballR)
logos <- rbind(load_espn_softball_scoreboard(2022)[c(2,4)] %>% `names<-`(c("team","logo")),
load_espn_softball_scoreboard(2022)[c(10,12)] %>% `names<-`(c("team","logo"))) %>%
distinct(team, logo) %>%
mutate(team = str_replace(team, "State", "St."),
team = str_replace(team, "Illinois", "Ill."),
team = str_replace(team, "Colorado", "Colo."),
team = str_replace(team, "Northern Kentucky", "Northern Ky."),
team = str_replace(team, "Boston University", "Boston U."),
team = str_replace(team, "Loyola Marymount", "LMU (CA)"),
team = str_replace(team, "Middle Tennessee", "Middle Tenn."),
team = str_replace(team, "Central Arkansas", "Central Ark."),
team = str_replace(team, "Long Island University", "LIU"),
team = str_replace(team, "&", "&amp;"),
team = str_replace(team, "North Carolina Central", "N.C. Central"),
team = str_replace(team, "Prairie View A&amp;M", "Prairie View")) %>%
rbind(data.frame(team = "George Mason", logo = "https://a.espncdn.com/combiner/i?img=/i/teamlogos/ncaa/500/2244.png&h=200&w=200"))
proportions <- readRDS("sim_proportions_2023.RDS") %>%
merge(logos, by.x = "team_name", by.y = "team")
proportions_1 <- proportions %>%
mutate(total = regionals + supers + semis + champs) %>%
arrange(desc(total)) %>%
head(n = 10)
proportions_2 <- proportions %>%
mutate(total = regionals + supers + semis + champs) %>%
arrange(desc(total)) %>%
filter(!(team_name %in% proportions_1$team_name)) %>%
head(n = 10)
table <- cbind(proportions_1, data.frame(X1 = "", X2 = ""), proportions_2) %>%
clean_names() %>%
select(logo, team_name, supers, semis, champs, x1, x2, logo_2, team_name_2, regionals_2, supers_2, semis_2, champs_2) %>%
gt() %>%
gt_img_rows(columns = logo) %>%
gt_img_rows(columns = logo_2) %>%
fmt_percent(c(3:6, 11:14), decimals = 1) %>%
cols_label(x1 = "", x2 = "",
logo = "", logo_2 = "",
team_name = "", team_name_2 = "",
supers = "WCWS", supers_2 = "WCWS",
semis = "Champ. Series", semis_2 = "Champ. Series",
champs = "Champion", champs_2 = "Champion") %>%
tab_style(style = cell_borders(sides = "left", color = "#d3d3d3"),
locations = list(cells_body(columns = x2),
cells_column_labels(columns = x2))) %>%
tab_style(style = cell_borders(sides = "left", style = "dashed", color = "#d3d3d3"),
locations = cells_body(columns = c(regionals, regionals_2))) %>%
tab_spanner(columns = 3:4,
label = "% Chance To Reach...",
id = "spanner_1") %>%
tab_spanner(columns = 10:12,
label = "% Chance To Reach...",
id = "spanner_2") %>%
tab_header(title = "2023 NCAA Tournament Predictions",
subtitle = "After 10000 Sims Using Model by @tking0426") %>%
gt_theme_espn() %>%
tab_options(heading.align = 'center')
table <- cbind(proportions_1, data.frame(X1 = "", X2 = ""), proportions_2) %>%
clean_names() %>%
select(logo, team_name, supers, semis, champs, x1, x2, logo_2, team_name_2, regionals_2, supers_2, semis_2, champs_2) %>%
gt() %>%
gt_img_rows(columns = logo) %>%
gt_img_rows(columns = logo_2) %>%
fmt_percent(c(3:5, 10:13), decimals = 1) %>%
cols_label(x1 = "", x2 = "",
logo = "", logo_2 = "",
team_name = "", team_name_2 = "",
supers = "WCWS", supers_2 = "WCWS",
semis = "Champ. Series", semis_2 = "Champ. Series",
champs = "Champion", champs_2 = "Champion") %>%
tab_style(style = cell_borders(sides = "left", color = "#d3d3d3"),
locations = list(cells_body(columns = x2),
cells_column_labels(columns = x2))) %>%
tab_style(style = cell_borders(sides = "left", style = "dashed", color = "#d3d3d3"),
locations = cells_body(columns = c(regionals, regionals_2))) %>%
tab_spanner(columns = 3:4,
label = "% Chance To Reach...",
id = "spanner_1") %>%
tab_spanner(columns = 10:12,
label = "% Chance To Reach...",
id = "spanner_2") %>%
tab_header(title = "2023 NCAA Tournament Predictions",
subtitle = "After 10000 Sims Using Model by @tking0426") %>%
gt_theme_espn() %>%
tab_options(heading.align = 'center')
cbind(proportions_1, data.frame(X1 = "", X2 = ""), proportions_2) %>%
clean_names() %>%
select(logo, team_name, supers, semis, champs, x1, x2, logo_2, team_name_2, regionals_2, supers_2, semis_2, champs_2) %>%
gt() %>%
gt_img_rows(columns = logo) %>%
gt_img_rows(columns = logo_2) %>%
fmt_percent(c(3:5, 10:13), decimals = 1) %>%
cols_label(x1 = "", x2 = "",
logo = "", logo_2 = "",
team_name = "", team_name_2 = "",
supers = "WCWS", supers_2 = "WCWS",
semis = "Champ. Series", semis_2 = "Champ. Series",
champs = "Champion", champs_2 = "Champion") %>%
tab_style(style = cell_borders(sides = "left", color = "#d3d3d3"),
locations = list(cells_body(columns = x2),
cells_column_labels(columns = x2)))
table <- cbind(proportions_1, data.frame(X1 = "", X2 = ""), proportions_2) %>%
clean_names() %>%
select(logo, team_name, supers, semis, champs, x1, x2, logo_2, team_name_2, regionals_2, supers_2, semis_2, champs_2) %>%
gt() %>%
gt_img_rows(columns = logo) %>%
gt_img_rows(columns = logo_2) %>%
fmt_percent(c(3:5, 10:13), decimals = 1) %>%
cols_label(x1 = "", x2 = "",
logo = "", logo_2 = "",
team_name = "", team_name_2 = "",
supers = "WCWS", supers_2 = "WCWS",
semis = "Champ. Series", semis_2 = "Champ. Series",
champs = "Champion", champs_2 = "Champion") %>%
tab_style(style = cell_borders(sides = "left", color = "#d3d3d3"),
locations = list(cells_body(columns = x2),
cells_column_labels(columns = x2))) %>%
tab_style(style = cell_borders(sides = "left", style = "dashed", color = "#d3d3d3"),
locations = cells_body(columns = c(supers, supers_2))) %>%
tab_spanner(columns = 3:4,
label = "% Chance To Reach...",
id = "spanner_1") %>%
tab_spanner(columns = 10:12,
label = "% Chance To Reach...",
id = "spanner_2") %>%
tab_header(title = "2023 NCAA Tournament Predictions",
subtitle = "After 10000 Sims Using Model by @tking0426") %>%
gt_theme_espn() %>%
tab_options(heading.align = 'center')
table
View(proportions_2)
proportions <- find_proportions(results)
proportions <- proportions %>%
merge(logos, by.x = "team_name", by.y = "team")
proportions_1 <- proportions %>%
mutate(total = regionals + supers + semis + champs) %>%
arrange(desc(total)) %>%
head(n = 8)
proportions_2 <- proportions %>%
mutate(total = regionals + supers + semis + champs) %>%
arrange(desc(total)) %>%
filter(!(team_name %in% proportions_1$team_name)) %>%
head(n = 8)
table <- cbind(proportions_1, data.frame(X1 = "", X2 = ""), proportions_2) %>%
clean_names() %>%
select(logo, team_name, supers, semis, champs, x1, x2, logo_2, team_name_2, regionals_2, supers_2, semis_2, champs_2) %>%
gt() %>%
gt_img_rows(columns = logo) %>%
gt_img_rows(columns = logo_2) %>%
fmt_percent(c(3:5, 10:13), decimals = 1) %>%
cols_label(x1 = "", x2 = "",
logo = "", logo_2 = "",
team_name = "", team_name_2 = "",
supers = "WCWS", supers_2 = "WCWS",
semis = "Champ. Series", semis_2 = "Champ. Series",
champs = "Champion", champs_2 = "Champion") %>%
tab_style(style = cell_borders(sides = "left", color = "#d3d3d3"),
locations = list(cells_body(columns = x2),
cells_column_labels(columns = x2))) %>%
tab_style(style = cell_borders(sides = "left", style = "dashed", color = "#d3d3d3"),
locations = cells_body(columns = c(supers, supers_2))) %>%
tab_spanner(columns = 3:4,
label = "% Chance To Reach...",
id = "spanner_1") %>%
tab_spanner(columns = 10:12,
label = "% Chance To Reach...",
id = "spanner_2") %>%
tab_header(title = "2023 NCAA Tournament Predictions",
subtitle = "After 10000 Sims Using Model by @tking0426") %>%
gt_theme_espn() %>%
tab_options(heading.align = 'center')
table
table <- cbind(proportions_1, data.frame(X1 = "", X2 = ""), proportions_2) %>%
clean_names() %>%
select(logo, team_name, supers, semis, champs, x1, x2, logo_2, team_name_2, supers_2, semis_2, champs_2) %>%
gt() %>%
gt_img_rows(columns = logo) %>%
gt_img_rows(columns = logo_2) %>%
fmt_percent(c(3:5, 10:13), decimals = 1) %>%
cols_label(x1 = "", x2 = "",
logo = "", logo_2 = "",
team_name = "", team_name_2 = "",
supers = "WCWS", supers_2 = "WCWS",
semis = "Champ. Series", semis_2 = "Champ. Series",
champs = "Champion", champs_2 = "Champion") %>%
tab_style(style = cell_borders(sides = "left", color = "#d3d3d3"),
locations = list(cells_body(columns = x2),
cells_column_labels(columns = x2))) %>%
tab_style(style = cell_borders(sides = "left", style = "dashed", color = "#d3d3d3"),
locations = cells_body(columns = c(supers, supers_2))) %>%
tab_spanner(columns = 3:4,
label = "% Chance To Reach...",
id = "spanner_1") %>%
tab_spanner(columns = 10:12,
label = "% Chance To Reach...",
id = "spanner_2") %>%
tab_header(title = "2023 NCAA Tournament Predictions",
subtitle = "After 10000 Sims Using Model by @tking0426") %>%
gt_theme_espn() %>%
tab_options(heading.align = 'center')
table <- cbind(proportions_1, data.frame(X1 = "", X2 = ""), proportions_2) %>%
clean_names() %>%
select(logo, team_name, supers, semis, champs, x1, x2, logo_2, team_name_2, supers_2, semis_2, champs_2) %>%
gt() %>%
gt_img_rows(columns = logo) %>%
gt_img_rows(columns = logo_2) %>%
fmt_percent(c(3:5, 10:12), decimals = 1) %>%
cols_label(x1 = "", x2 = "",
logo = "", logo_2 = "",
team_name = "", team_name_2 = "",
supers = "WCWS", supers_2 = "WCWS",
semis = "Champ. Series", semis_2 = "Champ. Series",
champs = "Champion", champs_2 = "Champion") %>%
tab_style(style = cell_borders(sides = "left", color = "#d3d3d3"),
locations = list(cells_body(columns = x2),
cells_column_labels(columns = x2))) %>%
tab_style(style = cell_borders(sides = "left", style = "dashed", color = "#d3d3d3"),
locations = cells_body(columns = c(supers, supers_2))) %>%
tab_spanner(columns = 3:4,
label = "% Chance To Reach...",
id = "spanner_1") %>%
tab_spanner(columns = 10:12,
label = "% Chance To Reach...",
id = "spanner_2") %>%
tab_header(title = "2023 NCAA Tournament Predictions",
subtitle = "After 10000 Sims Using Model by @tking0426") %>%
gt_theme_espn() %>%
tab_options(heading.align = 'center')
table
View(proportions_1)
View(proportions_2)
proportions_1 <- proportions %>%
mutate(total = regionals + supers + semis + champs) %>%
arrange(desc(champs)) %>%
head(n = 8)
proportions_2 <- proportions %>%
mutate(total = regionals + supers + semis + champs) %>%
arrange(desc(champs)) %>%
filter(!(team_name %in% proportions_1$team_name)) %>%
head(n = 8)
table <- cbind(proportions_1, data.frame(X1 = "", X2 = ""), proportions_2) %>%
clean_names() %>%
select(logo, team_name, supers, semis, champs, x1, x2, logo_2, team_name_2, supers_2, semis_2, champs_2) %>%
gt() %>%
gt_img_rows(columns = logo) %>%
gt_img_rows(columns = logo_2) %>%
fmt_percent(c(3:5, 10:12), decimals = 1) %>%
cols_label(x1 = "", x2 = "",
logo = "", logo_2 = "",
team_name = "", team_name_2 = "",
supers = "WCWS", supers_2 = "WCWS",
semis = "Champ. Series", semis_2 = "Champ. Series",
champs = "Champion", champs_2 = "Champion") %>%
tab_style(style = cell_borders(sides = "left", color = "#d3d3d3"),
locations = list(cells_body(columns = x2),
cells_column_labels(columns = x2))) %>%
tab_style(style = cell_borders(sides = "left", style = "dashed", color = "#d3d3d3"),
locations = cells_body(columns = c(supers, supers_2))) %>%
tab_spanner(columns = 3:4,
label = "% Chance To Reach...",
id = "spanner_1") %>%
tab_spanner(columns = 10:12,
label = "% Chance To Reach...",
id = "spanner_2") %>%
tab_header(title = "2023 NCAA Tournament Predictions",
subtitle = "After 10000 Sims Using Model by @tking0426") %>%
gt_theme_espn() %>%
tab_options(heading.align = 'center')
table
install.packages("nflseedR")
library(nflseedR)
proportions_1 <- proportions %>%
mutate(champs = fmt_pct_special(champs)) %>%
arrange(desc(champs)) %>%
head(n = 8)
proportions_2 <- proportions %>%
mutate(champs = fmt_pct_special(champs)) %>%
arrange(desc(champs)) %>%
filter(!(team_name %in% proportions_1$team_name)) %>%
head(n = 8)
table <- cbind(proportions_1, data.frame(X1 = "", X2 = ""), proportions_2) %>%
clean_names() %>%
select(logo, team_name, supers, semis, champs, x1, x2, logo_2, team_name_2, supers_2, semis_2, champs_2) %>%
gt() %>%
gt_img_rows(columns = logo) %>%
gt_img_rows(columns = logo_2) %>%
fmt_percent(c(3:5, 10:12), decimals = 1) %>%
cols_label(x1 = "", x2 = "",
logo = "", logo_2 = "",
team_name = "", team_name_2 = "",
supers = "WCWS", supers_2 = "WCWS",
semis = "Champ. Series", semis_2 = "Champ. Series",
champs = "Champion", champs_2 = "Champion") %>%
tab_style(style = cell_borders(sides = "left", color = "#d3d3d3"),
locations = list(cells_body(columns = x2),
cells_column_labels(columns = x2))) %>%
tab_style(style = cell_borders(sides = "left", style = "dashed", color = "#d3d3d3"),
locations = cells_body(columns = c(supers, supers_2))) %>%
tab_spanner(columns = 3:4,
label = "% Chance To Reach...",
id = "spanner_1") %>%
tab_spanner(columns = 10:12,
label = "% Chance To Reach...",
id = "spanner_2") %>%
tab_header(title = "2023 NCAA Tournament Predictions",
subtitle = "After 10000 Sims Using Model by @tking0426") %>%
gt_theme_espn() %>%
tab_options(heading.align = 'center')
table
proportions <- proportions %>%
merge(logos, by.x = "team_name", by.y = "team")
proportions_1 <- proportions %>%
mutate(total = regionals + supers + semis + champs) %>%
arrange(desc(champs)) %>%
head(n = 8)
proportions_2 <- proportions %>%
mutate(total = regionals + supers + semis + champs) %>%
arrange(desc(champs)) %>%
filter(!(team_name %in% proportions_1$team_name)) %>%
head(n = 8)
table <- cbind(proportions_1, data.frame(X1 = "", X2 = ""), proportions_2) %>%
clean_names() %>%
select(logo, team_name, supers, semis, champs, x1, x2, logo_2, team_name_2, supers_2, semis_2, champs_2) %>%
gt() %>%
gt_img_rows(columns = logo) %>%
gt_img_rows(columns = logo_2) %>%
fmt_percent(c(3:5, 10:12), decimals = 1) %>%
cols_label(x1 = "", x2 = "",
logo = "", logo_2 = "",
team_name = "", team_name_2 = "",
supers = "WCWS", supers_2 = "WCWS",
semis = "Champ. Series", semis_2 = "Champ. Series",
champs = "Champion", champs_2 = "Champion") %>%
tab_style(style = cell_borders(sides = "left", color = "#d3d3d3"),
locations = list(cells_body(columns = x2),
cells_column_labels(columns = x2))) %>%
tab_style(style = cell_borders(sides = "left", style = "dashed", color = "#d3d3d3"),
locations = cells_body(columns = c(supers, supers_2))) %>%
tab_spanner(columns = 3:4,
label = "% Chance To Reach...",
id = "spanner_1") %>%
tab_spanner(columns = 10:12,
label = "% Chance To Reach...",
id = "spanner_2") %>%
tab_header(title = "2023 NCAA Tournament Predictions",
subtitle = "After 10000 Sims Using Model by @tking0426") %>%
gt_theme_espn() %>%
tab_options(heading.align = 'center')
logos <- rbind(load_espn_softball_scoreboard(2022)[c(2,4)] %>% `names<-`(c("team","logo")),
load_espn_softball_scoreboard(2022)[c(10,12)] %>% `names<-`(c("team","logo"))) %>%
distinct(team, logo) %>%
mutate(team = str_replace(team, "State", "St."),
team = str_replace(team, "Illinois", "Ill."),
team = str_replace(team, "Colorado", "Colo."),
team = str_replace(team, "Northern Kentucky", "Northern Ky."),
team = str_replace(team, "Boston University", "Boston U."),
team = str_replace(team, "Loyola Marymount", "LMU (CA)"),
team = str_replace(team, "Middle Tennessee", "Middle Tenn."),
team = str_replace(team, "Central Arkansas", "Central Ark."),
team = str_replace(team, "Long Island University", "LIU"),
team = str_replace(team, "&", "&amp;"),
team = str_replace(team, "North Carolina Central", "N.C. Central"),
team = str_replace(team, "Prairie View A&amp;M", "Prairie View")) %>%
rbind(data.frame(team = "George Mason", logo = "https://a.espncdn.com/combiner/i?img=/i/teamlogos/ncaa/500/2244.png&h=200&w=200"))
proportions <- proportions %>%
merge(logos, by.x = "team_name", by.y = "team")
proportions_1 <- proportions %>%
mutate(total = regionals + supers + semis + champs) %>%
arrange(desc(champs)) %>%
head(n = 8)
proportions_2 <- proportions %>%
mutate(total = regionals + supers + semis + champs) %>%
arrange(desc(champs)) %>%
filter(!(team_name %in% proportions_1$team_name)) %>%
head(n = 8)
table <- cbind(proportions_1, data.frame(X1 = "", X2 = ""), proportions_2) %>%
clean_names() %>%
select(logo, team_name, supers, semis, champs, x1, x2, logo_2, team_name_2, supers_2, semis_2, champs_2) %>%
gt() %>%
gt_img_rows(columns = logo) %>%
gt_img_rows(columns = logo_2) %>%
fmt_percent(c(3:5, 10:12), decimals = 1) %>%
cols_label(x1 = "", x2 = "",
logo = "", logo_2 = "",
team_name = "", team_name_2 = "",
supers = "WCWS", supers_2 = "WCWS",
semis = "Champ. Series", semis_2 = "Champ. Series",
champs = "Champion", champs_2 = "Champion") %>%
tab_style(style = cell_borders(sides = "left", color = "#d3d3d3"),
locations = list(cells_body(columns = x2),
cells_column_labels(columns = x2))) %>%
tab_style(style = cell_borders(sides = "left", style = "dashed", color = "#d3d3d3"),
locations = cells_body(columns = c(supers, supers_2))) %>%
tab_spanner(columns = 3:4,
label = "% Chance To Reach...",
id = "spanner_1") %>%
tab_spanner(columns = 10:12,
label = "% Chance To Reach...",
id = "spanner_2") %>%
tab_header(title = "2023 NCAA Tournament Predictions",
subtitle = "After 10000 Sims Using Model by @tking0426") %>%
gt_theme_espn() %>%
tab_options(heading.align = 'center')
table
gtsave(table, "predictions_table.png")
